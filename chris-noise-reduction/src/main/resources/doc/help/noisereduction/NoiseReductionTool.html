<html>
<head>
    <title>CHRIS/PROBA Noise Reduction Tool</title>
    <link rel="stylesheet" href="../../style.css">
</head>

<body>

<table class="header">
    <tr class="header">
        <td class="header">&nbsp;
            CHRIS/PROBA Noise Reduction
        </td>
        <td class="header" align="right"><a href="../../index.html"><img src="../images/BeamHeader.jpg" border=0></a>
        </td>
    </tr>
</table>

<h3>CHRIS/PROBA Noise Reduction</h3>

<h4>Noise Reduction Algorithm</h4>


<h5>Motivation</h5>

<p>
    The Noise Reduction Tool is used to remove the vertical striping in CHRIS images caused by the slit effect and a
    superposition of high frequency noise.<br/>
    A well-known problem of CHRIS images is a spatial coherent noise known as vertical stripping (usually found in
    images acquired by push-broom sensors). This multiplicative noise in image columns comes from irregularities of the
    entrance slit and CCD elements in the across-track direction.
</p>

<h5>Description</h5>

<p>
    In addition to typical random noise, CHRIS hyperspectral images are affected by non-periodic partially deterministic
    disturbance patterns coming from the image formation process. The objective of this task is to correct or reduce
    these noise signals before any further processing.
    One of the errors affecting CHRIS images is the fact that transmission of channel 2 randomly produces wrong odd
    pixels in image rows (drop-outs). These errors must be identified (masked and unmasked drop-outs) and corrected by
    making use of both spatial and spectral information of the wrong pixel and its neighbours.
    Another well-known problem of CHRIS images is a spatial coherent noise known as vertical stripping (usually found in
    images acquired by push-broom sensors). This multiplicative noise in image columns comes from irregularities of the
    entrance slit and CCD elements in the across-track direction. Although the whole system was fully characterized
    after assembly, to obtain the gain correction factors that would produce an even image, the vertical pattern due to
    the slit is heavily dependant on the sensor temperature and must be modelled and corrected.
</p>

<h5>Solution</h5>

<p>
    In CHRIS images, drop-outs can be seen as missing pixels with zero or negative values. The processing must replace
    any invalid point using the average of the values of the valid neighbours. However, in order to avoid the poor
    performance of spatial filters in border or inhomogeneous areas, the contribution of each neighbouring pixel is
    weighted by its spectral distance to the corrected pixel. During this process, the values of bands with errors
    (indicated by the CHRIS HDF image quality mask) are not included in the computation of the spectral distance
    (Euclidean distance).
</p>
<ul>
    <li>At the present moment, the drop-out correction algorithm is well established and it is ready for implementation
        in the corresponding BEAM java module.
    </li>
    <li>The inputs required by the drop-out correction algorithm are the CHRIS raw image, spectral wavelengths, and
        quality mask imported from the HDF data file.
    </li>
    <li>The final implementation of the algorithm can be simplified in order to reduce the computational burden (at the
        expense of accuracy in the correction) depending on the quickness requirements.
    </li>
</ul>
<p>
    Standard vertical stripping reduction approaches take advantage of the constant noise factors in the image columns.
    Basically, the image is averaged in lines (along-track) and then the noise profile is estimated in the across-track
    direction for each band. By averaging image lines (integrated line profile) the surface contribution is smoothed;
    the additive random noise is cancelled; and the vertical stripping profile remains constant. In consequence, the
    surface contribution presents lower spatial frequencies in the across-track direction and can be easily separated
    from the vertical stripping (high frequencies) applying a filter with a suited cut-off frequency. However, this
    processing does not work well on all images. These methods do not take into account the possible high frequency
    components of the surface (high contrast linear features). In images presenting linear structures or patterns
    (usually man-made), which happen to be aligned with the along-track direction of the satellite, the averaged profile
    can present high frequencies due to the surface that will be interpreted as vertical stripping, thus some columns
    will be corrected with wrong values worsening the final image. The proposed correction method is also based on the
    hypothesis that the vertical disturbance presents higher spatial frequencies than the surface radiance. However, it
    models the noise pattern by suppressing the surface contribution in the across-track in two different ways: first,
    avoiding the high frequency changes due to surface, and then subtracting the low frequency profile.
</p>
<ul>
    <li>At the present moment, a prototype of the vertical stripping correction algorithm is available in Matlab
        programming language. However, further developments are being implemented in order to simplify the procedure and
        to include a model of the slit effect dependence on the sensor temperature, which should improve the results of
        the vertical stripping correction algorithm.
    </li>
    <li>The inputs required by the vertical stripping correction algorithm are the CHRIS image, spectral wavelengths,
        quality mask imported from the HDF data file, image acquisition parameters (acquisition mode, sensor
        temperature) extracted from the header information. Additionally, a LUT should contain a model of the vertical
        stripping produced by the sensor entrance slit.
    </li>
    <li>The vertical stripping correction can be improved by processing together the five multi-angular images from an
        acquisition set.
    </li>
</ul>

<h4>User Interface</h4>

<p>
    The Noise Reduction tool can be invoked from VISAT <b>Tools</b> menu by selecting
    the <b>Noise Reduction</b> command in the <b>CHRIS/PROBA Tools</b> submenu.
</p>

<h5>IO Parameters Tab</h5>

<p align="center">
    <img src="images/NoiseReductionDialog.jpg" alt="Noise Reduction Dialog"/>
</p>


<h6>Acquisition Set Group</h6>

<p>
    The table is initially filled with all products found belonging to the same acquisition set as the currently
    selected in VISAT. It is searched for those products in the same directory where the selected one resides.
    If now CHRIS product is initially selected the table will be empty.<br>
    The user can add/remove products belonging to one acquisition set.
</p>

<p class="i1">
    <b>Add:</b>
    The user can select one or multiple CHRIS products from a file chooser dialog. All selected products must belong to
    the same acquisition set.
</p>

<p class="i1">
    <b>Remove:</b>
    This removes the currently selected product from the table and thereby from processing.
</p>

<p class="i1">
    <b>Reduce Noise:</b>
    In the table the user can select if a product shall be noise reduced or not. If not it is only used to improve the
    noise reduction for the other products.
</p>

<h6>Image Metadata Group</h6>

<p>This groups displays metadata about the product selected in the table above.<br/>
    The metadata consists of the following information<br/>
    <b>CHRIS Mode</b>, <b>Target Name</b>, <b>Target Coordinates</b>, <b>Fly-by Zenith Angle</b> and <b>Minimum Zenith
    Angle</b>.
</p>

<h6>Target Product Group</h6>

<p class="i1">
    <b>Name pattern:</b>
    Specifies the name pattern applied to each target product. The pattern <b>${sourceName}</b> is replaced by the
    name of the source product.
</p>

<p class="i1">
    <b>Save as:</b>
    For the noise reduction this options is always checked. The combo box presents a list of file formats,
    currently BEAM-DIMAP, GeoTIFF, and HDF5.
    The text field allows to specify a target directory.
</p>

<p class="i1">
    <b>Open in VISAT:</b>
    Used to specify whether the target product should be opened in VISAT. When the
    the target product is not saved, it is opened in VISAT automatically.
</p>


<h5>Advanced Settings</h5>

<p>This button brings up a new dialog for advanced settings.</p>

<p align="center">
    <img src="images/NoiseReductionAdvSettings.jpg" alt="Noise Reduction Advanced Settings"/>
</p>

<h6>Destriping Group</h6>

<p class="i1">
    <b>Apply Slit Correction:</b>
    Whether or not to apply slit correction.
</p>

<p class="i1">
    <b>Smoothing Order:</b>
    The number of pixels used for smoothing.
</p>

<h6>Dropout Correction Group</h6>

<p class="i1">
    <b>Number of Neighbor Bands:</b>
    Specifies the number of neighbor bands considered for the dropout correction.
</p>

<p class="i1">
    <b>Neighborhood Type:</b>
    The Dropout Correction is based on the values of the four (nearest) or eight (all) neighbors of a pixel.<br/>
    <i>Four Connected Neighborhood</i>
</p>
<table class="i1">
    <tr>
        <td>0</td>
        <td>1</td>
        <td>0</td>
    </tr>
    <tr>
        <td>1</td>
        <td>0</td>
        <td>1</td>
    </tr>
    <tr>
        <td>0</td>
        <td>1</td>
        <td>0</td>
    </tr>
</table>
<p class="i1">
    <i>Eight Connected Neighborhood</i>
</p>
<table class="i1">
    <tr>
        <td>1</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>1</td>
        <td>0</td>
        <td>1</td>
    </tr>
    <tr>
        <td>1</td>
        <td>1</td>
        <td>1</td>
    </tr>
</table>

<h5>Dialog Buttons</h5>

<div class="i1">
    <b>Run</b>
    Creates the target product. The processing is actually deferred until the target band data are accessed,
    either by writing the product to the file system or by viewing the band data. When the <b>Save as</b> option is
    checked, the processing is triggered automatically.
    <p class="inote"><b>Note:</b><br/>
        Not only the noise reduced products will be written, but also products containing the <b>Vertical Striping
        Coefficients</b>.<br/>
        Those are located next to the noise reduced products and can be identified by the <b>VSC</b> suffix.
    </p>
</div>

<p class="i1">
    <b>Close</b>
    Closes the dialog.
</p>

<p class="i1">
    <b>Help</b>
    Displays this page in VISAT Help.
</p>


<hr>
</body>
</html>